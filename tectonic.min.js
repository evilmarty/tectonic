/*!
 * tectonic.min.js 0.2
 * http://evilmarty.github.com/tectonic/
 *
 * Copyright 2012, Marty Zalega
 * Under the MIT license.
 * http://www.opensource.org/licenses/MIT
 */
(function(c){function i(a){return c.isPlainObject(a)?c.extend(Object.create(j),a):g[a]?i(g[a]):Object.create(j)}Object.create||(Object.create=function(a){function b(){}if(1<arguments.length)throw Error("Object.create implementation only accepts the first parameter.");b.prototype=a;return new b});var j={setup:function(a){a.element.addClass("tectonic");a.item.addClass("tectonic-active")},teardown:function(a){a.element.removeClass("tectonic");a.items.filter(".tectonic-active").removeClass("tectonic-active")},
insert:function(a){var b;(b=a.items.get(a.index))?c(b).before(a.item):a.element.append(a.item);return true},remove:function(a){a.item.remove();return true},select:function(a){a.items.filter(".tectonic-active").removeClass("tectonic-active");a.items.eq(a.index).addClass("tectonic-active");return true},move:function(a){var b;(b=a.items.get(a.index))?c(b).before(a.item):a.element.append(a.item);return true}},g={},k=function(a,b){this.element=c(a);this.options=b||{};this.items=this.element.children(this.options.selector).toArray();
this.selected=this.get(this.options.selectedIndex||0);this._setLayout(this.options.layout)};c.extend(k.prototype,{destroy:function(){this._shutdownLayout();this.element.removeData("tectonic");var a=this;c.each(a,function(b){a[b]=null})},option:function(a,b){if(c.isPlainObject(a))for(var e in a)this._setOption(e,a[e]);else{if(b===void 0)return this._getOption(a);this._setOption(a,b)}},length:function(){return this.items.length},all:function(){return c.makeArray(this.items)},get:function(a){return this.items[this._normalizeIndex(a)]||
null},index:function(a){return c.inArray(c(a)[0],this.items)},append:function(a){this.insert(this.items.length,a)},prepend:function(a){this.insert(0,a)},insert:function(a,b){function e(){var b=h.pop(),c=f+a,g;if(b){g=d.index(b)!==-1;d._layout(g?"move":"insert",b,c,function(){d[g?"_moved":"_added"](b,c);e()});f++}}var d=this,h=c(b).toArray(),f=0,a=Math.min(this._normalizeIndex(a),this.items.length);e()},empty:function(){return this.remove(this.items)},remove:function(a){function b(){var a=e.shift(),
c=d.index(a);c!==-1&&d._layout("remove",a,c,function(){d._removed(a,c);b()})}if(typeof a==="number")return this.remove(this.items[this._normalizeIndex(a)]);var e=c(a).toArray(),d=this;b()},selectedIndex:function(a){if(a===void 0)return this.selected?this.index(this.selected):-1;var b=this.items[a],c=this;this.selected!==b&&this._layout("select",b,a,function(){c._selected(b,a)})},value:function(a){if(a===void 0)return this.selected||null;this.selectedIndex(this.index(a))},_trigger:function(a,b){if(c.isFunction(this.options[a])){b=
c.makeArray(b);b.unshift(c.Event(a));this.options[a].apply(this.element[0],b)}return this.element.trigger("tectonic"+a,b)},_getOption:function(a){return a==="selectedIndex"?this.selectedIndex():this.options[a]},_setOption:function(a,b){if(a==="selectedIndex")return this.selectedIndex(b);a==="layout"&&this._setLayout(b);this.options[a]=b},_normalizeIndex:function(a){for(;a<0;)a=this.items.length+a;return a},_setLayout:function(a){this._shutdownLayout();this.layout=i(a);this._layout("setup",this.selected,
this.selectedIndex())},_shutdownLayout:function(){if(this.layout){this._layout("teardown");delete this.layout;this.layout=null}},_layout:function(a,b,e,d){var b={element:this.element,item:c(b),index:e,items:c(this.items)},h;d||(d=function(){});h=this.layout[a](b,function(){h===void 0&&d()});h===true&&d()},_added:function(a,b){this.items.splice(b,0,a);this._trigger("add",{item:a,index:b})},_removed:function(a,b){var c=this.items.slice(b+1);this.items.length=b;this.items.push.apply(this.items,c);if(this.selected==
a)this.selected=null;this._trigger("remove",{item:a,index:b})},_selected:function(a,b){this.selected=a;this._trigger("select",{item:a,index:b})},_moved:function(a,b){var c=this.index(a),d=this.items.slice(c+1);this.items.length=c;this.items.push.apply(this.items,d);this.items.splice(b,0,a);this._trigger("move",{item:a,index:b})}});c.fn.tectonic=function(a){var b=typeof a==="string",e=Array.prototype.slice.call(arguments,1),d=this;b?this.each(function(){var b=c.data(this,"tectonic");if(!b)return c.error("cannot call methods on tectonic prior to initialization; attempted to call method '"+
a+"'");if(!c.isFunction(b[a])||a.charAt(0)==="_")return c.error("no such method '"+a+"' for tectonic instance");var f=b[a].apply(b,e);if(f!==b&&f!==void 0){d=f&&f.jquery?d.pushStack(f.get()):f;return false}}):this.each(function(){var b=c.data(this,"tectonic");if(b)a!==void 0&&b.option(a);else{b=new k(this,a);c.data(this,"tectonic",b)}});return d};c.tectonic=g})(jQuery);
